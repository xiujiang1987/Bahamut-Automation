/* minified */
const fetch=require("node-fetch"),countapi=require("countapi-js");function report({reward:e,answered:t}){let a="# å‹•ç•«ç˜‹ç­”é¡Œ\n\n";return e&&(a+=`âœ¨âœ¨âœ¨ ç²å¾— ${e} å·´å¹£ âœ¨âœ¨âœ¨
`),a+=t?`ğŸŸ¢ ä»Šæ—¥å·²ç­”é¡Œ
`:`âŒ ä»Šæ—¥å°šæœªç­”é¡Œ
`,a+="\n",a}exports.parameters=[{name:"answer_max_attempts",required:!1}],exports.run=async({page:t,outputs:e,params:a,logger:o})=>{var n=(...e)=>o.log("[95m[å‹•ç•«ç˜‹ç­”é¡Œ][m",...e);if(!e.login||!e.login.success)throw new Error("ä½¿ç”¨è€…æœªç™»å…¥ï¼Œç„¡æ³•ç­”é¡Œ");let r=0,s={};n("é–‹å§‹åŸ·è¡Œ");var m=+a.answer_max_attempts||3;for(let e=0;e<m;e++)try{if(n("æ­£åœ¨æª¢æ¸¬ç­”é¡Œç‹€æ…‹"),await t.goto("https://ani.gamer.com.tw/"),await t.waitForTimeout(200),s=await t.evaluate(()=>fetch("/ajax/animeGetQuestion.php?t="+Date.now()).then(e=>e.json())),s.question){const h=[null,s.a1,s.a2,s.a3,s.a4];n("å°šæœªå›ç­”ä»Šæ—¥é¡Œç›®ï¼Œå˜—è©¦ç­”é¡Œä¸­"),n("ä»Šå¤©çš„å•é¡Œï¼š"+s.question),n("é¸é …ï¼š"+h.filter(Boolean).join(", ")),n("æ­£åœ¨å°‹æ‰¾ç­”æ¡ˆ");var i=s.token,c=await fetch("https://api.gamer.com.tw/mobile_app/bahamut/v1/home.php?owner=blackXblue&page=1").then(e=>e.json()).then(e=>e.creation[0].sn),p=await fetch("https://api.gamer.com.tw/mobile_app/bahamut/v1/home_creation_detail.php?sn="+c).then(e=>e.json()).then(e=>e.content.match(/<body[\s\w"-=]*>([\s\S]*)<\/body>/)[0].match(/A[:ï¼š](\d)/gi)[0].match(/\d/)[0]).then(parseInt);n(`ç­”æ¡ˆæ˜¯ ${p}. ${h[p]} ï¼`),n("æ­£åœ¨å˜—è©¦å›ç­”");let e=await t.evaluate(({ans:e,token:t})=>fetch("/ajax/animeAnsQuestion.php",{headers:{accept:"*/*","content-type":"application/x-www-form-urlencoded","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},method:"POST",body:encodeURI(`token=${t}&ans=${e}&t=`+Date.now())}).then(e=>e.json()),{ans:p,token:i});e.error&&n("å›ç­”å•é¡Œæ™‚ç™¼ç”ŸéŒ¯èª¤ "+e.msg+" [91mâœ˜[m"),e.ok&&(n("å·²å›ç­”å•é¡Œ "+e.gift+" [92mâœ”[m"),r=+e.gift.match(/\d{2,4}/)[0])}else 1===s.error&&"ä»Šæ—¥å·²ç¶“ç­”éé¡Œç›®äº†ï¼Œä¸€å¤©åƒ…é™ä¸€æ¬¡æ©Ÿæœƒ"===s.msg?n("ä»Šæ—¥å·²ç¶“ç­”éé¡Œç›®äº† [92mâœ”[m"):n("ç™¼ç”ŸæœªçŸ¥éŒ¯èª¤ï¼š"+s.msg+" [91mâœ˜[m");await t.waitForTimeout(1e3);break}catch(e){o.error(e),n("ç™¼ç”ŸéŒ¯èª¤ï¼Œé‡è©¦ä¸­ [91mâœ˜[m")}return n("åŸ·è¡Œå®Œç•¢ âœ¨"),r&&countapi.update("Bahamut-Automation","answer",r),{answered:!(1!==s.error&&!r),reward:r,report:report}};