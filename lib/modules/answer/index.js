/* minified */
"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const node_fetch_1=__importDefault(require("node-fetch")),countapi_js_1=__importDefault(require("countapi-js")),_module_1=__importDefault(require("../_module")),answer=new _module_1.default;function report({reward:e,answered:t}){let a="# å‹•ç•«ç˜‹ç­”é¡Œ\n\n";return e&&(a+=`âœ¨âœ¨âœ¨ ç²å¾— ${e} å·´å¹£ âœ¨âœ¨âœ¨
`),a+=t?`ğŸŸ¢ ä»Šæ—¥å·²ç­”é¡Œ
`:`âŒ ä»Šæ—¥å°šæœªç­”é¡Œ
`,a+="\n",a}answer.parameters=[{name:"answer_max_attempts",required:!1}],answer.run=async({page:t,outputs:e,params:a,logger:o})=>{var r=(...e)=>o.log("[95m[å‹•ç•«ç˜‹ç­”é¡Œ][m",...e);if(!e.login||!e.login.success)throw new Error("ä½¿ç”¨è€…æœªç™»å…¥ï¼Œç„¡æ³•ç­”é¡Œ");let n=0,s={};r("é–‹å§‹åŸ·è¡Œ");var i=+a.answer_max_attempts||3;for(let e=0;e<i;e++)try{if(r("æ­£åœ¨æª¢æ¸¬ç­”é¡Œç‹€æ…‹"),await t.goto("https://ani.gamer.com.tw/"),await t.waitForTimeout(200),s=await t.evaluate(()=>(0,node_fetch_1.default)("/ajax/animeGetQuestion.php?t="+Date.now()).then(e=>e.json())),s.question){const p=[null,s.a1,s.a2,s.a3,s.a4];r("å°šæœªå›ç­”ä»Šæ—¥é¡Œç›®ï¼Œå˜—è©¦ç­”é¡Œä¸­"),r("ä»Šå¤©çš„å•é¡Œï¼š"+s.question),r("é¸é …ï¼š"+p.filter(Boolean).join(", ")),r("æ­£åœ¨å°‹æ‰¾ç­”æ¡ˆ");var m=s.token,u=await(0,node_fetch_1.default)("https://api.gamer.com.tw/mobile_app/bahamut/v1/home.php?owner=blackXblue&page=1").then(e=>e.json()).then(e=>e.creation[0].sn),c=await(0,node_fetch_1.default)("https://api.gamer.com.tw/mobile_app/bahamut/v1/home_creation_detail.php?sn="+u).then(e=>e.json()).then(e=>e.content.match(/<body[\s\w"-=]*>([\s\S]*)<\/body>/)[0].match(/A[:ï¼š](\d)/gi)[0].match(/\d/)[0]).then(parseInt);r(`ç­”æ¡ˆæ˜¯ ${c}. ${p[c]} ï¼`),r("æ­£åœ¨å˜—è©¦å›ç­”");let e=await t.evaluate(async({ans:e,token:t})=>{const a=await(0,node_fetch_1.default)("/ajax/animeAnsQuestion.php",{headers:{accept:"*/*","content-type":"application/x-www-form-urlencoded","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},method:"POST",body:encodeURI(`token=${t}&ans=${e}&t=`+Date.now())});return a.json()},{ans:c,token:m});e.error&&r("å›ç­”å•é¡Œæ™‚ç™¼ç”ŸéŒ¯èª¤ "+e.msg+" [91mâœ˜[m"),e.ok&&(r("å·²å›ç­”å•é¡Œ "+e.gift+" [92mâœ”[m"),n=+e.gift.match(/\d{2,4}/)[0])}else 1===s.error&&"ä»Šæ—¥å·²ç¶“ç­”éé¡Œç›®äº†ï¼Œä¸€å¤©åƒ…é™ä¸€æ¬¡æ©Ÿæœƒ"===s.msg?r("ä»Šæ—¥å·²ç¶“ç­”éé¡Œç›®äº† [92mâœ”[m"):r("ç™¼ç”ŸæœªçŸ¥éŒ¯èª¤ï¼š"+s.msg+" [91mâœ˜[m");await t.waitForTimeout(1e3);break}catch(e){o.error(e),r("ç™¼ç”ŸéŒ¯èª¤ï¼Œé‡è©¦ä¸­ [91mâœ˜[m")}return r("åŸ·è¡Œå®Œç•¢ âœ¨"),n&&countapi_js_1.default.update("Bahamut-Automation","answer",n),{answered:!(1!==s.error&&!n),reward:n,report:report}},exports.default=answer;